



COUNTER CACHE

migration:
class AddCommentsCountToArticles < ActiveRecord::Migration
  def change
    add_column :articles, :comments_count, :integer, default: 0
  end
end


model:

class Comment < ActiveRecord::Base
  belongs_to :user
  belongs_to :article, counter_cache: true
  has_many :votes, as: :votable
end

then run in rails console >>> Article.pluck(:id).each{ |id| Article.reset_counters(id, :comments) }

then use .comments_count NOT .count on Artilce
